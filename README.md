# ml4ports
Web application for managing smart ports.


# Notes for Apex Charts

* use following SQL to get data for MongoDB

```SELECT
DD.CONTAINER_KEY,DD.CONTAINER_NO, CS.DESCRIPTION AS C_STATUS, CK.DESCRIPTION AS C_KIND, CT.DESCRIPTION AS C_TYPE,
  ISNULL(C.COMPANY_NAME, CA.COMPANY_NAME) AS COMPANY ,
  CA.COMPANY_KEY,
  G.GOODS_NAME,
  G.GOODS_GROUP_KEY,
  FL.LINE_KEY,
  FL.LINE_NAME,
  FO.ORDER_KEY,
  FO.MOORAGE_DATE,
  FS.SHIP_NAME
FROM PORTDATA.DBO.DUMMY_DWELL2 DD
LEFT JOIN PORTDATA.DBO.V_TBL_CONTAINER_STATUS CS ON CS.CONTAINER_STATUS_KEY = DD.CONTAINER_STATUS_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_CONTAINER_TYPES CT ON CT.CONTAINER_TYPE_KEY = DD.CONTAINER_TYPE_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_CONTAINER_KINDS CK ON CK.CONTAINER_KIND_KEY = DD.CONTAINER_KIND_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_STORAGE_DAYS SD ON SD.STORAGE_DAY_KEY = DD.STORAGE_DAY_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_CONTAINER_JOB_ORDERS CJO_F ON CJO_F.MAIN_CONTAINER_JOB_ORDER_KEY = SD.FIRST_CONTAINER_JOB_ORDER_KEY AND CJO_F.OFFER_TYPE = DD.FOFFER_TYPE
LEFT JOIN PORTDATA.DBO.V_TBL_CONTAINER_JOB_ORDERS CJO_L ON CJO_L.MAIN_CONTAINER_JOB_ORDER_KEY = SD.LAST_CONTAINER_JOB_ORDER_KEY AND CJO_L.OFFER_TYPE = DD.LOFFER_TYPE
LEFT JOIN PORTDATA.DBO.V_TBL_SERVICE_GROUPS SG ON SG.OFFER_TYPE = DD.FOFFER_TYPE
LEFT JOIN PORTDATA.DBO.V_TBL_SERVICE_GROUPS SG1 ON SG1.OFFER_TYPE = DD.LOFFER_TYPE
LEFT JOIN PORTDATA.DBO.V_TBL_COMPANIES CA ON CA.COMPANY_KEY=DD.AGENT_COMPANY_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_WAREHOUSE W1 ON W1.WAREHOUSE_KEY =
(SELECT TOP 1 WX.WAREHOUSE_KEY FROM PORTDATA.DBO.V_TBL_WAREHOUSE WX
       WHERE WX.CONTAINER_JOB_ORDER_KEY = CJO_F.CONTAINER_JOB_ORDER_KEY)
LEFT JOIN PORTDATA.DBO.V_TBL_COMPANIES C ON C.COMPANY_KEY=W1.COMPANY_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_GOODS G ON G.GOODS_KEY = W1.GOODS_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_ORDERS FO ON FO.ORDER_KEY = CJO_F.ORDER_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_ORDERS LO ON LO.ORDER_KEY = CJO_L.ORDER_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_LINES FL ON FL.LINE_KEY = FO.LINE_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_LINES LL ON LL.LINE_KEY = LO.LINE_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_SHIPS FS ON FS.SHIP_KEY = FO.SHIP_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_SHIPS LS ON LS.SHIP_KEY = LO.SHIP_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_CONTAINER_SHIP_ORDERS FCSO ON FCSO.CONTAINER_SHIP_ORDER_KEY = CJO_F.CONTAINER_SHIP_ORDER_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_BAY_PLAN FBP ON FBP.CONTAINER_SHIP_ORDER_KEY = FCSO.CONTAINER_SHIP_ORDER_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_PORTS FP ON FP.PORT_KEY = FBP.DEPT_PORT_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_PORTS FP1 ON FP1.PORT_KEY = FBP.LOAD_PORT_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_CONTAINER_SHIP_ORDERS LCSO ON LCSO.CONTAINER_SHIP_ORDER_KEY = CJO_L.CONTAINER_SHIP_ORDER_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_BAY_PLAN LBP ON LBP.CONTAINER_SHIP_ORDER_KEY = LCSO.CONTAINER_SHIP_ORDER_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_PORTS LP ON LP.PORT_KEY = LBP.DLVR_PORT_KEY
LEFT JOIN PORTDATA.DBO.V_TBL_PORTS LP1 ON LP1.PORT_KEY = LBP.DISC_PORT_KEY
WHERE CJO_F.SUCCESS_DATE_TIME > '2016-01-01 00:00:00.000' AND GOODS_NAME IS NOT NULL```
